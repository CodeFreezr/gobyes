Modularized the code; put code into different packages.